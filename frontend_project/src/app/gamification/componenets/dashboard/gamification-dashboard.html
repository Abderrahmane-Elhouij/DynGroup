<div class="grid grid-cols-12 gap-8">
    <!-- En-tete bienvenue -->
    <div class="col-span-12">
        <div class="bg-primary rounded-2xl p-8 text-primary-contrast">
            <h1 class="text-3xl font-bold mb-2">Bienvenue sur la plateforme de Dynamique des Groupes</h1>
            <p class="text-lg opacity-90">Explorez les cours, gagnez de l'XP et montez en niveau !</p>
        </div>
    </div>

    @if (loading()) { @for (i of [1,2,3,4]; track i) {
    <div class="col-span-12 md:col-span-6 xl:col-span-3">
        <div class="card h-full">
            <p-skeleton height="6rem" />
        </div>
    </div>
    } } @else {
    <!-- Statistiques -->
    <div class="col-span-12 md:col-span-6 xl:col-span-3">
        <div class="card h-full">
            <div class="flex items-center justify-between mb-4">
                <span class="text-surface-500 dark:text-surface-400 font-medium">XP Total</span>
                <div class="flex items-center justify-center bg-primary/10 rounded-full" style="width: 2.5rem; height: 2.5rem">
                    <i class="pi pi-star-fill text-primary text-xl"></i>
                </div>
            </div>
            <div class="text-3xl font-bold text-surface-900 dark:text-surface-0">{{ dashboard()?.xpTotal || 0 }}</div>
            <span class="text-surface-500 dark:text-surface-400 text-sm">points d'experience</span>
        </div>
    </div>

    <div class="col-span-12 md:col-span-6 xl:col-span-3">
        <div class="card h-full">
            <div class="flex items-center justify-between mb-4">
                <span class="text-surface-500 dark:text-surface-400 font-medium">Niveau</span>
                <div class="flex items-center justify-center bg-teal-100 dark:bg-teal-900 rounded-full" style="width: 2.5rem; height: 2.5rem">
                    <i class="pi pi-arrow-up text-teal-500 text-xl"></i>
                </div>
            </div>
            <div class="text-3xl font-bold text-surface-900 dark:text-surface-0">{{ dashboard()?.niveau || 1 }}</div>
            <div class="mt-2">
                <p-progressBar [value]="xpProgress()" [showValue]="false" styleClass="h-2" />
                <span class="text-surface-500 dark:text-surface-400 text-xs mt-1 block">{{ xpInLevel() }} / 100 XP pour le prochain niveau</span>
            </div>
        </div>
    </div>

    <div class="col-span-12 md:col-span-6 xl:col-span-3">
        <div class="card h-full">
            <div class="flex items-center justify-between mb-4">
                <span class="text-surface-500 dark:text-surface-400 font-medium">Cours</span>
                <div class="flex items-center justify-center bg-orange-100 dark:bg-orange-900 rounded-full" style="width: 2.5rem; height: 2.5rem">
                    <i class="pi pi-book text-orange-500 text-xl"></i>
                </div>
            </div>
            <div class="text-3xl font-bold text-surface-900 dark:text-surface-0">{{ dashboard()?.coursInscrits || 0 }}</div>
            <span class="text-surface-500 dark:text-surface-400 text-sm">cours inscrits</span>
        </div>
    </div>

    <div class="col-span-12 md:col-span-6 xl:col-span-3">
        <div class="card h-full">
            <div class="flex items-center justify-between mb-4">
                <span class="text-surface-500 dark:text-surface-400 font-medium">Lecons</span>
                <div class="flex items-center justify-center bg-cyan-100 dark:bg-cyan-900 rounded-full" style="width: 2.5rem; height: 2.5rem">
                    <i class="pi pi-file text-cyan-500 text-xl"></i>
                </div>
            </div>
            <div class="text-3xl font-bold text-surface-900 dark:text-surface-0">{{ dashboard()?.leconsTerminees || 0 }}</div>
            <span class="text-surface-500 dark:text-surface-400 text-sm">lecons terminees</span>
        </div>
    </div>

    <!-- Cours recents -->
    <div class="col-span-12 xl:col-span-8">
        <div class="card">
            <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-semibold text-surface-900 dark:text-surface-0 m-0">Mes cours en cours</h2>
                <p-button label="Voir tout" icon="pi pi-arrow-right" [text]="true" [routerLink]="['/cours']" />
            </div>
            @if (dashboard()?.coursRecents?.length) {
            <div class="flex flex-col gap-4">
                @for (cours of dashboard()!.coursRecents; track cours.id) {
                <div class="flex items-center p-4 border border-surface-200 dark:border-surface-700 rounded-xl hover:bg-surface-50 dark:hover:bg-surface-800 transition-colors cursor-pointer" [routerLink]="['/cours', cours.id]">
                    <div class="flex items-center justify-center bg-primary/10 rounded-xl mr-4" style="width: 3rem; height: 3rem">
                        <i class="pi pi-book text-primary text-xl"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="font-semibold text-surface-900 dark:text-surface-0 mb-1 truncate">{{ cours.titre }}</div>
                        <p-progressBar [value]="cours.progression" [showValue]="false" styleClass="h-2" />
                    </div>
                    <div class="ml-4 flex flex-col items-end">
                        <span class="font-bold text-primary">{{ cours.progression }}%</span>
                        <p-tag [value]="cours.difficulte" [severity]="getDifficultyColor(cours.difficulte)" />
                    </div>
                </div>
                }
            </div>
            } @else {
            <div class="text-center py-8">
                <i class="pi pi-book text-4xl text-surface-300 dark:text-surface-600 mb-4 block"></i>
                <p class="text-surface-500 dark:text-surface-400">Aucun cours en cours</p>
                <p-button label="Explorer les cours" icon="pi pi-search" [routerLink]="['/cours']" class="mt-4" />
            </div>
            }
        </div>
    </div>

    <!-- Badges -->
    <div class="col-span-12 xl:col-span-4">
        <div class="card h-full">
            <h2 class="text-xl font-semibold text-surface-900 dark:text-surface-0 mb-6 m-0">Mes badges</h2>
            @if (dashboard()?.derniersBadges?.length) {
            <div class="grid grid-cols-3 gap-4">
                @for (badge of dashboard()!.derniersBadges; track badge.id) {
                <div class="flex flex-col items-center text-center p-3 rounded-xl bg-surface-50 dark:bg-surface-800" [pTooltip]="badge.description" tooltipPosition="top">
                    <div class="flex items-center justify-center bg-primary/10 rounded-full mb-2" style="width: 3rem; height: 3rem">
                        <i class="pi pi-trophy text-primary text-xl"></i>
                    </div>
                    <span class="text-xs font-medium text-surface-700 dark:text-surface-300">{{ badge.nom }}</span>
                </div>
                }
            </div>
            } @else {
            <div class="text-center py-8">
                <i class="pi pi-trophy text-4xl text-surface-300 dark:text-surface-600 mb-4 block"></i>
                <p class="text-surface-500 dark:text-surface-400">Completez des lecons pour gagner des badges !</p>
            </div>
            }
        </div>
    </div>
    }
</div>
